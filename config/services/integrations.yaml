services:
    # Auto-tag all integration implementations
    _defaults:
        autowire: true
        autoconfigure: true

    # Central registry for all integrations
    App\Integration\IntegrationRegistry:
        public: true
        arguments:
            $integrations: !tagged_iterator 'app.integration'

    # System Tools - Don't require user-specific external credentials (e.g., Jira tokens)
    # Still protected by API Basic Auth
    App\Integration\SystemTools\ShareFileIntegration:
        tags: ['app.integration']

    App\Integration\SystemTools\ContentLearnIntegration:
        tags: ['app.integration']

    App\Integration\SystemTools\ContentQueryIntegration:
        tags: ['app.integration']

    App\Integration\SystemTools\ReadFileIntegration:
        tags: ['app.integration']

    App\Integration\SystemTools\EmployeeQueryIntegration:
        tags: ['app.integration']

    App\Integration\SystemTools\EmployeeProfileIntegration:
        tags: ['app.integration']

    App\Integration\SystemTools\PowerPointGeneratorIntegration:
        tags: ['app.integration']

    App\Integration\SystemTools\PdfGeneratorIntegration:
        tags: ['app.integration']

    App\Integration\SystemTools\WebSearchIntegration:
        tags: ['app.integration']

    App\Integration\SystemTools\WebPageReaderIntegration:
        tags: ['app.integration']

    App\Integration\SystemTools\CompanyEventsIntegration:
        tags: ['app.integration']

    App\Integration\SystemTools\MemoryManagementIntegration:
        tags: ['app.integration']

    App\Integration\SystemTools\IssueReportingIntegration:
        tags: ['app.integration']

    # User Integrations - Require user-specific external service credentials
    App\Integration\UserIntegrations\JiraIntegration:
        tags: ['app.integration']

    App\Integration\UserIntegrations\ConfluenceIntegration:
        tags: ['app.integration']

    App\Integration\UserIntegrations\SharePointIntegration:
        tags: ['app.integration']

    App\Integration\UserIntegrations\TrelloIntegration:
        tags: ['app.integration']

    App\Integration\UserIntegrations\GitLabIntegration:
        tags: ['app.integration']

    App\Integration\UserIntegrations\SapC4cIntegration:
        tags: ['app.integration']

    App\Integration\UserIntegrations\ProjektronIntegration:
        tags: ['app.integration']

    App\Integration\UserIntegrations\HubSpotIntegration:
        tags: ['app.integration']

    App\Integration\UserIntegrations\SapSacIntegration:
        tags: ['app.integration']

    # OAuth Services for custom OAuth flows (not using knp_oauth2_client)
    App\Service\Integration\AtlassianOAuthService:
        arguments:
            $clientId: '%env(default::ATLASSIAN_CLIENT_ID)%'
            $clientSecret: '%env(default::ATLASSIAN_CLIENT_SECRET)%'
            $redirectUri: '%env(APP_URL)%/integrations/oauth/callback/atlassian'